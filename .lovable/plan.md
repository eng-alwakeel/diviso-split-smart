
# Diviso UI V2 — صفحة المجموعة + المصاريف

## ملخص التغييرات
تحسين بصري شامل لصفحة تفاصيل المجموعة وكروت المصاريف، مع الحفاظ على جميع الوظائف والنرد في مكانه.

---

## A) صفحة المجموعة (GroupDetails.tsx) — إعادة ترتيب

### 1. Group Hero Compact
**الملف:** `src/components/group/GroupCard.tsx` — تعديل `ExpandedCard`

التغييرات:
- تقليل padding من `p-6` إلى `p-4`
- إزالة Avatar الكبير (14×14) واستبداله بأيقونة صغيرة أو إخفاؤه
- ملخص سريع في سطر واحد: "7 أعضاء · 95 ر.س"
- الأزرار: زر أساسي "+ إضافة مصروف" + زر "تقرير" + قائمة (⋯) تحتوي على الإعدادات + إنهاء النشاط + حذف/مغادرة
- إزالة زر "إنهاء النشاط" و"إعدادات" من الأزرار المباشرة ونقلها داخل الـ DropdownMenu

### 2. قسم النرد (ثابت بعد الهيدر)
**الملف:** `src/components/group/GroupDiceCard.tsx` — تحسين بصري

التغييرات:
- إضافة سطر يوضح نوع النرد الحالي (مثل: "نرد: اختيار مطبخ اليوم")
- إضافة سطر "آخر نتيجة" إن كان outcome متاحاً (يظهر آخر نتيجة حتى بعد إعادة فتح الصفحة من الـ state)
- تقليل padding قليلاً لتقليل الارتفاع
- لا تغيير في الترتيب — يبقى بعد الهيدر مباشرة (كما هو حالياً)

### 3. لوحة المؤشرات — Grid 2×2
**الملف:** `src/pages/GroupDetails.tsx` — سطور 574-674

التغييرات:
- تغيير `grid-cols-1 md:grid-cols-4` إلى `grid-cols-2` مع `gap-3`
- تقليل padding الكروت من `p-6` إلى `p-3`
- الأرقام أكبر (text-3xl font-black)
- العناوين أصغر (text-xs)
- إزالة الأيقونة الكبيرة (w-12 h-12) واستبدالها بأيقونة صغيرة بجانب العنوان
- كل كرت قابل للنقر (`onClick` → يفتح التبويب المناسب)
- المصاريف: عرض "معتمد: 95" و "معلّق: 550" بوضوح
- fallback عمود واحد للشاشات الصغيرة جداً: `grid-cols-1 min-[340px]:grid-cols-2`

### 4. آخر الأحداث — مضغوط
**الملف:** `src/components/group/GroupActivityFeed.tsx`

التغييرات:
- تقليل ارتفاع كل عنصر: سطر واحد فقط (الرسالة + الزمن في نفس السطر)
- الزمن مختصر ("2س" / "1ي" بدل "قبل 2 ساعة")
- أيقونات أصغر (w-5 h-5)
- تلوين خفيف حسب النوع (انضمام: أخضر خفيف، مصروف: أصفر خفيف، تسوية: أزرق خفيف)

### 5. ترتيب الصفحة النهائي
في `GroupDetails.tsx` بعد كروت المجموعة:
1. Group Hero (Compact) — موجود حالياً
2. النرد — موجود حالياً بالترتيب الصحيح
3. Dashboard Grid 2×2 — تحويل من 4 أعمدة
4. آخر الأحداث — موجود حالياً
5. Tabs (المصاريف/الأعضاء/التسويات/الميزانية/الدردشة)

---

## B) كروت المصاريف — Card V2

### 1. فلاتر أفقية
**الملف:** `src/pages/GroupDetails.tsx` — داخل TabsContent "expenses"

إضافة شريط فلاتر scrollable أفقي قبل قائمة المصاريف:
- أزرار: الكل | معتمد | معلّق | مرفوض
- فلترة عرض فقط (useState محلي)

### 2. كرت المصروف V2
**الملف:** `src/pages/GroupDetails.tsx` — سطور 702-856

التغييرات:
- إزالة تكرار Badge الحالة (يظهر مرة واحدة فقط في أعلى يسار الكرت)
- المبلغ يبقى أكبر عنصر (text-2xl font-black) لكن ليس text-4xl
- تقليل padding من `p-5` إلى `p-3`
- أيقونة التصنيف أصغر (w-10 h-10 بدل w-14 h-14)
- ترتيب RTL: يمين: أيقونة | وسط: عنوان + دافع | يسار: مبلغ + تاريخ + badge
- أزرار الموافقة/الرفض أصغر (h-7 w-7) وأقل سطوعاً (opacity-70)
- زر الحذف أقل بروزاً (ghost بدل outline)

### 3. ألوان الحالة
- معتمد: `bg-green-500/10 text-green-600 border-green-500/20`
- معلّق: `bg-amber-500/10 text-amber-600 border-amber-500/20`
- مرفوض: `bg-muted text-muted-foreground`

---

## C) تحسين Tabs
**الملف:** `src/pages/GroupDetails.tsx` — سطر 678

- إضافة تأثير glow خفيف على التبويب النشط
- تحسين بصري عبر className مخصص على TabsTrigger النشط

---

## D) الملفات المتأثرة

| الملف | نوع التغيير |
|-------|-------------|
| `src/components/group/GroupCard.tsx` | تعديل ExpandedCard لجعله compact |
| `src/components/group/GroupDiceCard.tsx` | تحسين بصري + سطر نوع النرد |
| `src/components/group/GroupActivityFeed.tsx` | ضغط العناصر + تلوين خفيف |
| `src/pages/GroupDetails.tsx` | Grid 2×2 + فلاتر + كرت V2 + ترتيب |

---

## E) قيود مُلتزم بها
- النرد يبقى ظاهراً دائماً بعد الهيدر
- لا تغيير في API calls أو schemas
- RTL محفوظ 100%
- جميع الوظائف (إضافة/اعتماد/رفض/حذف) تعمل كما هي
- Bottom Nav لا يتداخل مع المحتوى
